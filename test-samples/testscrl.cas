
  CLS
  HIGH
  PLANE 1

; DRAW A SERIES OF SPRITES
; and then scroll

  LD  VE, 0
  LD  VD, 1

  ; TEST SCROLLING DOWN 1 PIXEL ON ALL PLANES

  CALL  SETUP

  PLANE 3
  SCRL DOWN  1

  PLANE 1
  ; SHOULD HAVE MOVED DOWN 1
  LD  V0, 68
  LD  V1, 33
  DRW V0, V1, 1
  SE  VF, VD
  JP  FAILED5

  PLANE 1
  ; SHOULD HAVE MOVED DOWN 1
  LD  V0, 60
  LD  V1, 33
  DRW V0, V1, 1
  SE  VF, VD
  JP  FAILED5

  PLANE 2
  ; SHOULD ALSO HAVE MOVED UP 1
  LD  V0, 60
  LD  V1, 33
  DRW V0, V1, 1
  SE  VF, VD
  JP  FAILED5

  PLANE 2
  ; SHOULD HAVE MOVED UP 1
  LD  V0, 68
  LD  V1, 34
  DRW V0, V1, 1
  SE  VF, VD
  JP  FAILED5

  ; TEST SCROLLING UP 1 PIXEL ON ALL PLANES

  CALL  SETUP

  PLANE 3
  SCRL UP  1

  PLANE 1
  ; SHOULD HAVE MOVED UP 1
  LD  V0, 60
  LD  V1, 31
  DRW V0, V1, 1
  SE  VF, VD
  JP  FAILED5

  PLANE 2
  ; SHOULD ALSO HAVE MOVED UP 1
  LD  V0, 60
  LD  V1, 31
  DRW V0, V1, 1
  SE  VF, VD
  JP  FAILED5

  PLANE 2
  ; SHOULD HAVE MOVED UP 1
  LD  V0, 68
  LD  V1, 32
  DRW V0, V1, 1
  SE  VF, VD
  JP  FAILED5

  PLANE 1
  ; SHOULD HAVE MOVED UP 1
  LD  V0, 68
  LD  V1, 31
  DRW V0, V1, 1
  SE  VF, VD
  JP  FAILED5

  ; TEST SCROLLING UP 1 PIXEL

  CALL  SETUP
  PLANE 1
  SCRL UP 1

  LD  V0, 58
  LD  V1, 32
  DRW V0, V1, 1

  ; SHOULD HAVE MOVED - SO NO OVERLAP
  SE  VF, VE
  JP  FAILED4

  ; SHOULD OVER LAP NOW
  LD  V0, 60
  LD  V1, 31
  DRW V0, V1, 1

  SE  VF, VD
  JP  FAILED4


  ;TEST SCROLLING DOWN 1 PLANE FOR 1 PIXEL

  CALL  SETUP
  PLANE 1
  SCRL DOWN 1

  LD  V0, 60
  LD  V1, 32
  DRW V0, V1, 1

  ; SHOULD HAVE MOVED - SO NO OVERLAP
  SE  VF, VE
  JP  FAILED4

  ; SHOULD OVER LAP NOW
  LD  V0, 60
  LD  V1, 33
  DRW V0, V1, 1

  SE  VF, VD
  JP  FAILED4

  CLS

  ; TEST SCROLLING DOWN 1 PIXEL
  PLANE 2
  LD  I, SOLID
  LD  V0, 60
  LD  V1, 32
  DRW V0, V1, 1

  LD  V0, 60
  LD  V1, 0
  DRW V0, V1, 1

  LD  V0, 0
  LD  V1, 0
  DRW V0, V1, 1

  SCRL DOWN 1

  LD  V0, 60
  LD  V1, 32
  DRW V0, V1, 1

  ; SHOULD HAVE MOVED - SO NO OVERLAP
  SE  VF, VE
  JP  FAILED3

  ; SHOULD OVER LAP NOW
  LD  V0, 60
  LD  V1, 33
  DRW V0, V1, 1

  SE  VF, VD
  JP  FAILED1

  ; TEST SCROLLING DOWN 2 PIXELS
  CLS
  PLANE 2
  LD  I, SOLID
  LD  V0, 60
  LD  V1, 32
  DRW V0, V1, 1

  SCRL DOWN 2

  LD  V0, 60
  LD  V1, 32
  DRW V0, V1, 1

  ; SHOULD HAVE MOVED - SO NO OVERLAP
  SE  VF, VE
  JP  FAILED3

  LD  V0, 60
  LD  V1, 33
  DRW V0, V1, 1

  ; SHOULD HAVE MOVED - SO NO OVERLAP
  SE  VF, VE
  JP  FAILED2

  ; SHOULD OVER LAP NOW
  LD  V0, 60
  LD  V1, 34
  DRW V0, V1, 1

  SE  VF, VD
  JP  FAILED2


OK:
  LD  I, OK_PATTERN
  LD  V0, 0
  LD  V1, 58
  DRW V0, V1, 5
  RET

FAILED0:
  LD  VC, 0
  JP  SHOWERR

FAILED1:
  LD  VC, 1
  JP  SHOWERR

FAILED2:
  LD  VC, 2
  JP  SHOWERR

FAILED3:
  LD  VC, 3
  JP  SHOWERR

FAILED4:
  LD  VC, 4
  JP  SHOWERR

FAILED5:
  LD  VC, 5
  JP  SHOWERR

MARKERS:
  LD  V2, 120
  LD  V3, 0

LOOP:
  DRW V2, V3, 1
  ADD V3, 2

  SE  V3, 64
  JP  LOOP
  RET


SHOWERR:
  LDF I, VC
  LD  V0, 0
  LD  V1, 58
  DRW  V0, V1, 5
  RET

SETUP:
  CLS

  PLANE 1
  LD  I, SOLID
  LD  V0, 60
  LD  V1, 32
  DRW V0, V1, 1

  LD  V0, 68
  LD  V1, 32
  DRW V0, V1, 1

  LD  V0, 16
  LD  V1, 16
  DRW V0, V1, 2

  CALL  MARKERS

  PLANE 2
  CALL  MARKERS

  LD  V0, 68
  LD  V1, 33
  DRW  V0, V1, 1

  LD  V0, 24
  LD  V1, 16
  DRW V0, V1, 2

  LD  I, SOLID
  LD  V0, 60
  LD  V1, 32
  DRW V0, V1, 1

  LD  V0, 60
  LD  V1, 0
  DRW V0, V1, 1

  LD  V0, 0
  LD  V1, 0
  DRW V0, V1, 1
  RET

OK_PATTERN:
  DB  234, 172, 168, 172, 234

PATTERN1:
  DB  170, 170, 170, 170, 170, 170, 170, 170

PATTERN2:
  DB  14, 15, 255, 15, 15, 15, 15, 15

PATTERN3:
  DB  240, 240, 240, 240, 240, 240, 240, 240

SOLID:
  DB  255, 255, 255, 255, 255, 255, 255, 255
